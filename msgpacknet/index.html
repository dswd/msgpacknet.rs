<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <meta name="description" content="API documentation for the Rust `msgpacknet` crate.">
    <meta name="keywords" content="rust, rustlang, rust-lang, msgpacknet">

    <title>msgpacknet - Rust</title>

    <link rel="stylesheet" type="text/css" href="../main.css">

    
    
</head>
<body class="rustdoc">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    

    <nav class="sidebar">
        
        <p class='location'></p><script>window.sidebarCurrent = {name: 'msgpacknet', ty: 'mod', relpath: '../'};</script>
    </nav>

    <nav class="sub">
        <form class="search-form js-only">
            <div class="search-container">
                <input class="search-input" name="search"
                       autocomplete="off"
                       placeholder="Click or press ‘S’ to search, ‘?’ for more options…"
                       type="search">
            </div>
        </form>
    </nav>

    <section id='main' class="content mod">
<h1 class='fqn'><span class='in-band'>Crate <a class='mod' href=''>msgpacknet</a></span><span class='out-of-band'><span id='render-detail'>
            <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">
                [<span class='inner'>&#x2212;</span>]
            </a>
        </span><a id='src-0' class='srclink' href='../src/msgpacknet/lib.rs.html#1-118' title='goto source code'>[src]</a></span></h1>
<div class='docblock'><p>A networking layer based on MessagePack messages.</p>

<p>This crate provides an abstraction layer above TCP that uses
<a href="http://www.msgpack.org">MessagePack</a> encoded messages instead of pure byte
streams. It also abstracts from addresses and connections and instead uses
node identifiers to distinguish and address nodes.</p>

<p>The main struct of this crate is <a href="struct.Node.html"><code>Node</code></a> which can be
parametrized:</p>

<ul>
<li><p><a href="trait.Message.html"><code>Message</code></a> - The nodes using this crate communicate
via messages that conform to the <code>Message</code> trait. These messages are
serialized using <code>serde</code> to the efficient MessagePack format.</p></li>
<li><p><a href="trait.NodeId.html"><code>NodeId</code></a> - This crate identifies and distinguishes
nodes based on their <code>NodeId</code>. It is required that all communicating nodes
have different ids.
Therefore the node ids should be unique. This can be achieved by using the
IP address and port number of the main listening socket. Alternatively, a
large random number can be used (128 bit should be enough to expect
uniqueness).</p></li>
<li><p><a href="trait.InitMessage.html"><code>InitMessage</code></a> - The first message exchanged on
all connections uses the <code>InitMessage</code> trait instead of <code>Message</code>.</p></li>
</ul>

<h1 id="low-level-protocol" class='section-header'><a
                           href="#low-level-protocol">Low-level protocol</a></h1>
<p>When establishing a new connection (either incoming or outgoing), first an
<code>InitMessage</code> is sent to the remote node together with the local <code>NodeId</code>
and then the initialization message and the remote <code>NodeId</code> is read from
that node.
After inspecting the initialization message, the connection is either
rejected and closed or accepted and added to the connection registry.</p>

<p>When established, the connection can be used to send multiple messages of
the <code>Message</code> type.</p>

<p>When idle for a certain timeout or when closing the node by dropping its
<a href="struct.CloseGuard.html"><code>CloseGuard</code></a>, the connection is closed.</p>

<h1 id="examples" class='section-header'><a
                           href="#examples">Examples</a></h1>
<p>To use this crate, first a <a href="struct.Node.html"><code>Node</code></a> has to be created
with a node id and an initialization message which are sent to other nodes
as first message.</p>
<pre class='rust rust-example-rendered'>
<span class='kw'>use</span> <span class='ident'>msgpacknet</span>::<span class='op'>*</span>;
<span class='kw'>let</span> <span class='ident'>node</span> <span class='op'>=</span> <span class='ident'>Node</span>::<span class='op'>&lt;</span><span class='ident'>String</span>, (<span class='ident'>u64</span>, <span class='ident'>u64</span>)<span class='op'>&gt;</span>::<span class='ident'>create_default</span>();</pre>

<p>Then, sockets can be opened for listening and accepting connections.
The method
<a href="struct.Node.html#method.listen_defaults"><code>node.listen_defaults()</code></a> can be
used to listen on free ports on IPv4 and IPv6.</p>
<pre class='rust rust-example-rendered'>
<span class='ident'>node</span>.<span class='ident'>listen_defaults</span>().<span class='ident'>expect</span>(<span class='string'>&quot;Failed to bind&quot;</span>);</pre>

<p>The actual addresses can be obtained using
<a href="struct.Node.html#method.addresses"><code>node.addresses()</code></a>.</p>
<pre class='rust rust-example-rendered'>
<span class='macro'>println</span><span class='macro'>!</span>(<span class='string'>&quot;Addresses: {:?}&quot;</span>, <span class='ident'>node</span>.<span class='ident'>addresses</span>());
<span class='kw'>let</span> <span class='ident'>addr</span> <span class='op'>=</span> <span class='ident'>node</span>.<span class='ident'>addresses</span>()[<span class='number'>0</span>];</pre>

<p>Connections to other nodes can be established via
<a href="struct.Node.html#method.connect"><code>connect(...)</code></a>. The result of the call
is the remote side&#39;s node id.</p>
<pre class='rust rust-example-rendered'>
<span class='kw'>let</span> <span class='ident'>peer_id</span> <span class='op'>=</span> <span class='ident'>node</span>.<span class='ident'>connect</span>(<span class='ident'>addr</span>).<span class='ident'>expect</span>(<span class='string'>&quot;Failed to connect&quot;</span>);</pre>

<p>Then, messages can be sent via
<a href="struct.Node.html#method.send"><code>send(...)</code></a>...</p>
<pre class='rust rust-example-rendered'>
<span class='kw'>let</span> <span class='ident'>msg</span> <span class='op'>=</span> <span class='string'>&quot;Hello world&quot;</span>.<span class='ident'>to_owned</span>();
<span class='ident'>node</span>.<span class='ident'>send</span>(<span class='kw-2'>&amp;</span><span class='ident'>peer_id</span>, <span class='kw-2'>&amp;</span><span class='ident'>msg</span>).<span class='ident'>expect</span>(<span class='string'>&quot;Failed to send&quot;</span>);</pre>

<p>...and received via <a href="struct.Node.html#method.receive"><code>receive()</code></a>.</p>
<pre class='rust rust-example-rendered'>
<span class='kw'>let</span> <span class='ident'>event</span> <span class='op'>=</span> <span class='ident'>node</span>.<span class='ident'>receive</span>();</pre>
</div><h2 id='structs' class='section-header'><a href="#structs">Structs</a></h2>
<table>
                    <tr class=' module-item'>
                        <td><a class='struct' href='struct.CloseGuard.html'
                               title='msgpacknet::CloseGuard'>CloseGuard</a></td>
                        <td class='docblock short'>
                             <p>A guard that closes the node when dropped.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='struct' href='struct.ConnectionRequest.html'
                               title='msgpacknet::ConnectionRequest'>ConnectionRequest</a></td>
                        <td class='docblock short'>
                             <p>The request to establish a connection</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='struct' href='struct.ConnectionStats.html'
                               title='msgpacknet::ConnectionStats'>ConnectionStats</a></td>
                        <td class='docblock short'>
                             <p>Statistics of one connection</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='struct' href='struct.Node.html'
                               title='msgpacknet::Node'>Node</a></td>
                        <td class='docblock short'>
                             <p>The node struct</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='struct' href='struct.NodeStats.html'
                               title='msgpacknet::NodeStats'>NodeStats</a></td>
                        <td class='docblock short'>
                             <p>Node statistics</p>

                        </td>
                    </tr>
                </table><h2 id='enums' class='section-header'><a href="#enums">Enums</a></h2>
<table>
                    <tr class=' module-item'>
                        <td><a class='enum' href='enum.Error.html'
                               title='msgpacknet::Error'>Error</a></td>
                        <td class='docblock short'>
                             <p>The error type used througout the crate</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='enum' href='enum.Event.html'
                               title='msgpacknet::Event'>Event</a></td>
                        <td class='docblock short'>
                             <p>The enum used for events</p>

                        </td>
                    </tr>
                </table><h2 id='traits' class='section-header'><a href="#traits">Traits</a></h2>
<table>
                    <tr class=' module-item'>
                        <td><a class='trait' href='trait.InitMessage.html'
                               title='msgpacknet::InitMessage'>InitMessage</a></td>
                        <td class='docblock short'>
                             <p>The trait used for initialization messages</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='trait' href='trait.Message.html'
                               title='msgpacknet::Message'>Message</a></td>
                        <td class='docblock short'>
                             <p>The trait used for messages</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='trait' href='trait.NodeId.html'
                               title='msgpacknet::NodeId'>NodeId</a></td>
                        <td class='docblock short'>
                             <p>The trait used for node identifiers</p>

                        </td>
                    </tr>
                </table></section>
    <section id='search' class="content hidden"></section>

    <section class="footer"></section>

    <aside id="help" class="hidden">
        <div>
            <h1 class="hidden">Help</h1>

            <div class="shortcuts">
                <h2>Keyboard Shortcuts</h2>

                <dl>
                    <dt>?</dt>
                    <dd>Show this help dialog</dd>
                    <dt>S</dt>
                    <dd>Focus the search field</dd>
                    <dt>&larrb;</dt>
                    <dd>Move up in search results</dd>
                    <dt>&rarrb;</dt>
                    <dd>Move down in search results</dd>
                    <dt>&#9166;</dt>
                    <dd>Go to active search result</dd>
                </dl>
            </div>

            <div class="infos">
                <h2>Search Tricks</h2>

                <p>
                    Prefix searches with a type followed by a colon (e.g.
                    <code>fn:</code>) to restrict the search to a given type.
                </p>

                <p>
                    Accepted types are: <code>fn</code>, <code>mod</code>,
                    <code>struct</code>, <code>enum</code>,
                    <code>trait</code>, <code>type</code>, <code>macro</code>,
                    and <code>const</code>.
                </p>

                <p>
                    Search functions by type signature (e.g.
                    <code>vec -> usize</code>)
                </p>
            </div>
        </div>
    </aside>

    

    <script>
        window.rootPath = "../";
        window.currentCrate = "msgpacknet";
        window.playgroundUrl = "";
    </script>
    <script src="../jquery.js"></script>
    <script src="../main.js"></script>
    
    <script async src="../search-index.js"></script>
</body>
</html>